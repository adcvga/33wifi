# 3wifi тыцпыц edition

Камрад попросил собрать ему локальную версию 3wifi для своих нужд, в принципе можно даже на сервер ее запушить, но я бы
еще пробежался с точки зрения безопасности по репозиторию. А для непубличного применения вполне себе.

Взят оригинальный [репозиторий 3wifi](https://github.com/binarymaster/3WiFi), внесены изменения на мой вкус, в условиях
ограниченного времени.

## Что поменялось

- Все полностью в докере и сам сайт и все воркеры
- Переезд с apache на nginx
- php-fpm 7.2 c небольшой оптимизацией
- другая некромантия, много некромантии
- добавлен легковесный менеджер баз данных доступен на порту 8080
- добавлен клинер, который убивает все txt файлы в папке uploads
- не знаю точно на какой версии базы данных оно должно ехать в оригинале, но теперь mysql:latest
- включены все кэши, все воркеры задействованы

## Требования

Довольно прожорливая конфигурация, можно переделать на alpine, но мне откровенно лень =)
Поэтому озу рекомендую от 2гб (лучше 4), ядер проца от 2 (лучше 4), диска думаю 20гб на сколько-то хватит. Тут конечно
все зависит от интенсивности использования.

Важно , в дефолте для удобства влепил 80 порт, он должен быть свободен, если занят уже чем-то - идем в docker-compose
и правим на тот который нравится и свободен.

## Установка

1. Установить настроить docker compose.

2. В файле `code/config.php`
    - define('YMAPS_APIKEY', `'Сюда добавить api ключ от яндекс карт javascript'`);
    - define('YLOCATOR_APIKEY', `'Сюда влепить ключ от api яндекс локатора'`);
3. Запуcкать командой `docker compose up -d` в директории с файлом docker-compose
4. смотрим на кучу ошибок и не пугаемся, прогрев базы от минуты до 10 при первом запуске, это нормально. Ничего
   рестартить и суетиться не надо.

Сервис доступен по адресу http://localhost:80 

ЗЫ: ssl не прикручивал, поэтому тока http